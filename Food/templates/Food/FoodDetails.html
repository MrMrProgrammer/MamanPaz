{% extends 'base/layout.html' %}
{% load static %}

{% block HeaderLinks %}
    <link rel="stylesheet" href="{% static 'css/Moms/FoodDetails-style.css' %}">
    <script src="{% static 'js/jquery.js' %}"></script>
    <script src="{% static 'js/script.js' %}"></script>

{% endblock %}

{% block main %}

    <div class="row">

        <div class="col-md-6">

            <div class="food-detail">

                <div class="row text-center">
                    <div class="col-6">
                        <h2>{{ food }}</h2>
                    </div>
                    <div class="col-6">
                        <h3>
                            {{ food.food_price }} تومان
                        </h3>
                    </div>
                </div>

                <div class="row text-center">
                    <div class="col-6">
                        <a href="{% url 'MomProfile' mom_id=food.mom.user_id %}">
                            <img style="display: inline;" class="mom-profile" src="{% url 'getMomImage' mom_id=food.mom_id %}"/>
                            <p style="display: inline">مامان {{ food.mom.user.first_name }}</p>
                        </a>
                    </div>
                    <div class="col-6">امتیاز غذا</div>
                </div>

                <br/>

                {% if food.food_order != 0 %}
                    <div class="row text-center">
                        <div class="col-12">
                            <p>{{ food.food_name }} دستپخت {{ food.mom.user.first_name }} تاکنون
                                <strong>{{ food.food_order }}</strong>+ بار سفارش داده شده است.</p>
                        </div>
                    </div>
                {% endif %}

                <hr/>

                <p class="dastor-pokht">دستور پخت</p>
                <p>{{ food.food_recipe }}</p>

                <hr/>

                <br/>

                <div class="row text-center">
                    <div id="count" class="col-12">
                        <button onclick="oppositeCount()" class="btn btn-primary">-</button>
                        <p id="counter">4</p>
                        <button onclick="addCount()" class="btn btn-primary">+</button>
                    </div>
                </div>

                <br/>

                <div class="row">
                    <div class="col-12 text-center">
                        {% if request.user.is_authenticated %}

                            <button id="addToOrderBtn" onclick="addFoodToOrder({{ food.id }})"
                                    class="text-center btn btn-danger">
                                <span id="plus-icon">+</span> افزودن به سبد خرید
                            </button>
                            <button id="success" class="text-center btn btn-success"> غذا با موفقیت به سبد خرید اضافه شد
                            </button>
                        {% else %}
                            <button id="showAlert"
                                    onclick="alert('کاربرگرامی برای افزودن غذا به سبد خرید باید ابتدا وارد حساب کاربری خود شوید.')"
                                    class="text-center btn btn-danger">
                                <span id="plus-icon">+</span> افزودن به سبد خرید
                            </button>
                        {% endif %}

                    </div>
                </div>
            </div>

            {% if user_can_comment %}

                <br/>

                <div class="food-detail">

                <div class="row">
                    <div class="col-12 text-center">
                        <h5>ثبت نظر شما</h5>
                    </div>
                </div>

                <hr/>

                <div class="row text-center">
                    <div class="col-12">
                        <form method="post" action="{% url 'FoodDetails' food_id=food.id %}">
                            {% csrf_token %}

                            <div class="row text-right">
                                <div class="col-3">
                                    <p>میزان رضایت شما : </p>
                                </div>

                                <div class="col-9">
                                    {{ add_comment_form.user_experience }}
                                    {{ add_comment_form.user_experience.errors }}
                                </div>
                            </div>

                            <br/>

                            {{ add_comment_form.text }}

                            <br/>

                            <button type="submit" class="btn btn-primary">ثبت نظر</button>

                        </form>
                    </div>
                </div>

            </div>

            {% endif %}

            <br/>

            <div class="food-detail">

                <div class="row">
                    <div class="col-12 text-center">
                        <h5>نظرات کاربران درباره غذا {{ food.food_name }}</h5>
                    </div>
                </div>

                {% for comment in comments %}

                    <hr/>

                    <div class="row">
                        <div class="col-12">
                            <div class="row">
                                <div class="col-2 text-center">

                                    <div class="row">
                                        <div class="col-12">
                                            <img class="ux-icon" src="{{ comment.UX.icon.url }}"/>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <p>{{ comment.user.first_name }}</p>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-10">
                                    <div class="row text-right">
                                        <div class="col-12">
                                            <p>{{ comment.date }}</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12">
                                            <p>{{ comment.text }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {% if comment.is_answered %}
                                yes
                            {% else %}
                                no
                            {% endif %}
                            <form>
                                <div class="row text-center">

                                    <div class="col-9">
                                            {{ add_answer_form.text }}
                                    </div>

                                    <div class="col-3">
                                        <button class="btn btn-primary" type="submit">پاسخ</button>
                                    </div>

                                </div>
                            </form>

                        </div>

                    </div>
                {% endfor %}


            </div>


        </div>

        <div class="col-md-6">

            <div class="row">
                <div class="col-12 text-center">
                    <img id="food-photo" src="{{ food.food_photo.url }}"/>
                </div>
            </div>

            <br/>

            <div class="row">
                <div class="col-12">
                    <div class="food-detail">

                        <div class="row text-center">
                            <div class="col-12">
                                <h3 style="margin: 0">سایر غذاهای مامان {{ food.mom.user.first_name }}</h3>
                            </div>
                        </div>

                        {% for food in other_food %}
                            <hr/>
                            <a href="{% url 'FoodDetails' food_id=food.id %}">
                                <div class="row text-center">
                                    <div class="col-6">
                                        <p style="margin: 0">{{ food.food_name }}</p>
                                    </div>
                                    <div class="col-6">{{ food.food_price }} تومان</div>
                                </div>
                            </a>
                        {% endfor %}

                    </div>
                </div>
            </div>

        </div>

    </div>


{% endblock %}